<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>רבי עקיבא Pro - תיקון תצוגה סופי</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Segoe UI', sans-serif; }
        #ui {
            position: absolute; top: 10px; right: 10px;
            color: #fff; background: rgba(0,0,0,0.9);
            padding: 15px; border-right: 5px solid #ffcc00; border-radius: 8px;
            z-index: 100; text-align: right;
        }
        #controls {
            position: absolute; bottom: 30px; left: 30px;
            display: grid; grid-template-columns: repeat(3, 70px); grid-gap: 10px; z-index: 100;
        }
        .btn {
            width: 70px; height: 70px; background: rgba(255,255,255,0.2);
            border: 1px solid #fff; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            color: white; font-size: 25px; user-select: none;
        }
        @media (min-width: 1024px) { #controls { display: none; } }
    </style>
</head>
<body>

    <div id="ui">
        <strong>רחוב רבי עקיבא - מצב לילה</strong><br>
        אם עדיין שחור, נסה לרענן (F5).
    </div>

    <div id="controls">
        <div id="up" class="btn" style="grid-column: 2;">↑</div>
        <div id="left" class="btn" style="grid-column: 1; grid-row: 2;">←</div>
        <div id="down" class="btn" style="grid-column: 2; grid-row: 2;">↓</div>
        <div id="right" class="btn" style="grid-column: 3; grid-row: 2;">→</div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r152/three.min.js"></script>

    <script>
        // וידוא שהדפדפן תומך ב-WebGL
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x050505);

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // תאורה חזקה מאוד לביטחון
        const ambient = new THREE.AmbientLight(0xffffff, 1.5);
        scene.add(ambient);

        const sun = new THREE.DirectionalLight(0xffffff, 1);
        sun.position.set(5, 10, 7);
        scene.add(sun);

        // כביש פשוט בצבע אפור בהיר כדי שיהיה קל לראות
        const road = new THREE.Mesh(
            new THREE.PlaneGeometry(50, 2000),
            new THREE.MeshStandardMaterial({ color: 0x333333 })
        );
        road.rotation.x = -Math.PI / 2;
        scene.add(road);

        // רכב שחקן - קובייה כחולה ברורה
        const player = new THREE.Mesh(
            new THREE.BoxGeometry(2, 1, 4),
            new THREE.MeshStandardMaterial({ color: 0x0066ff })
        );
        player.position.y = 0.5;
        scene.add(player);

        // בניינים פשוטים בצדדים
        for(let i = -500; i < 500; i += 50) {
            const b1 = new THREE.Mesh(new THREE.BoxGeometry(10, 20, 10), new THREE.MeshStandardMaterial({color: 0x222222}));
            b1.position.set(-25, 10, i);
            scene.add(b1);
            const b2 = b1.clone();
            b2.position.x = 25;
            scene.add(b2);
        }

        const keys = {};
        window.onkeydown = e => keys[e.code] = true;
        window.onkeyup = e => keys[e.code] = false;

        function animate() {
            requestAnimationFrame(animate);

            if(keys['ArrowUp']) player.position.z += 0.5;
            if(keys['ArrowDown']) player.position.z -= 0.5;
            if(keys['ArrowLeft']) player.position.x -= 0.3;
            if(keys['ArrowRight']) player.position.x += 0.3;

            camera.position.set(player.position.x, 10, player.position.z - 15);
            camera.lookAt(player.position);

            renderer.render(scene, camera);
        }
        animate();

        window.onresize = () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        };
    </script>
</body>
</html>
